---
layout: post
title: "Python å­—å…¸åˆå¹¶çš„å…­ç§æ–¹æ³•ï¼Œæˆ‘æ‰“èµŒä½ åªçŸ¥é“å‰ä¸¤ç§"
date: 2026-02-07 06:00:00 +0800
categories:
  - ä»£ç æŠ€å·§
tags:
  - Python
  - å­—å…¸
  - æŠ€å·§
  - ç¼–ç¨‹
excerpt: "å­—å…¸æ˜¯ Python æœ€å¸¸ç”¨çš„æ•°æ®ç»“æ„ä¹‹ä¸€ï¼Œä½†åˆå¹¶ä¸¤ä¸ªå­—å…¸çš„æ­£ç¡®æ–¹å¼ï¼Œå¯èƒ½æ¯”ä½ æƒ³è±¡çš„è¦å¤š..."
header:
  overlay_image: https://images.unsplash.com/photo-1526379095098-d400fd0bf935?w=1920
  overlay_filter: 0.6
  teaser: https://images.unsplash.com/photo-1526379095098-d400fd0bf935?w=500
toc: true
toc_sticky: true
---

## å¼•è¨€

å­—å…¸ï¼ˆDictionaryï¼‰æ˜¯ Python ä¸­æœ€å¸¸ç”¨çš„æ•°æ®ç»“æ„ä¹‹ä¸€ã€‚æ— è®ºæ˜¯é…ç½®ç®¡ç†ã€æ•°æ®å¤„ç†è¿˜æ˜¯ API å“åº”ï¼Œå‡ ä¹æ¯ä¸ª Python ç¨‹åºå‘˜æ¯å¤©éƒ½è¦å’Œå­—å…¸æ‰“äº¤é“ã€‚

ä½†ä½ çŸ¥é“åˆå¹¶ä¸¤ä¸ªå­—å…¸æœ‰å‡ ç§æ–¹æ³•å—ï¼Ÿ

**ç­”æ¡ˆï¼šè‡³å°‘å…­ç§ã€‚**

æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»æ¯ç§æ–¹æ³•çš„ä¼˜ç¼ºç‚¹ï¼Œå¸®åŠ©ä½ åœ¨ä¸åŒåœºæ™¯ä¸‹åšå‡ºæœ€ä½³é€‰æ‹©ã€‚

## æ–¹æ³•ä¸€ï¼šupdate() æ–¹æ³•

è¿™æ˜¯æœ€å¤è€ã€æœ€ç›´æ¥çš„æ–¹æ³•ã€‚

```python
dict1 = {'a': 1, 'b': 2}
dict2 = {'b': 3, 'c': 4}

dict1.update(dict2)
print(dict1)  # {'a': 1, 'b': 3, 'c': 4}
```

### ç‰¹ç‚¹
- **å°±åœ°ä¿®æ”¹**ç¬¬ä¸€ä¸ªå­—å…¸
- è¿”å›å€¼ä¸º `None`
- å¦‚æœé”®å†²çªï¼Œç¬¬äºŒä¸ªå­—å…¸çš„å€¼ä¼šè¦†ç›–ç¬¬ä¸€ä¸ª

### ä½¿ç”¨åœºæ™¯
å½“ä½ éœ€è¦**åŸåœ°æ›´æ–°**ä¸€ä¸ªå­—å…¸ï¼Œè€Œä¸éœ€è¦ä¿ç•™åŸå§‹ç‰ˆæœ¬æ—¶ï¼Œè¿™æ˜¯æœ€çœå†…å­˜çš„é€‰æ‹©ã€‚

### æ³¨æ„
```python
# âŒ å¸¸è§é”™è¯¯
new_dict = dict1.update(dict2)  # new_dict æ˜¯ Noneï¼
```

---

## æ–¹æ³•äºŒï¼šå­—å…¸æ¨å¯¼å¼

è¿™æ˜¯ä¸€ç§æ›´ã€ŒPythonicã€çš„æ–¹å¼ã€‚

```python
dict1 = {'a': 1, 'b': 2}
dict2 = {'b': 3, 'c': 4}

merged = {**dict1, **dict2}
print(merged)  # {'a': 1, 'b': 3, 'c': 4}
```

### ç‰¹ç‚¹
- åˆ›å»º**æ–°å­—å…¸**
- è¯­æ³•ç®€æ´ã€å¯è¯»æ€§å¥½
- Python 3.5+ æ”¯æŒ

### ä½¿ç”¨åœºæ™¯
å½“ä½ éœ€è¦åˆå¹¶ä¸¤ä¸ªå­—å…¸å¹¶**ä¿ç•™åŸå§‹å­—å…¸ä¸å˜**æ—¶ï¼Œè¿™æ˜¯é¦–é€‰æ–¹æ³•ã€‚

### è¿›é˜¶ç”¨æ³•
```python
# åˆå¹¶å¤šä¸ªå­—å…¸
dict1 = {'a': 1}
dict2 = {'b': 2}
dict3 = {'c': 3}

merged = {**dict1, **dict2, **dict3}
# {'a': 1, 'b': 2, 'c': 3}

# åˆå¹¶æ—¶è®¾ç½®é»˜è®¤å€¼
config = {**default_config, **user_config}
```

---

## æ–¹æ³•ä¸‰ï¼šdict() æ„é€ å‡½æ•° + unpack

ä¸æ–¹æ³•äºŒç±»ä¼¼ï¼Œä½†ä½¿ç”¨ `dict()` æ„é€ å‡½æ•°ã€‚

```python
dict1 = {'a': 1, 'b': 2}
dict2 = {'b': 3, 'c': 4}

merged = dict(dict1, **dict2)
print(merged)  # {'a': 1, 'b': 3, 'c': 4}
```

### ç‰¹ç‚¹
- åˆ›å»º**æ–°å­—å…¸**
- åªæ”¯æŒå•ä¸ª `**` å‚æ•°
- å¯è¯»æ€§ç•¥ä½äºæ–¹æ³•äºŒ

### æ³¨æ„
è¿™ç§è¯­æ³•æœ‰ä¸€ä¸ª**é™åˆ¶**ï¼šå¦‚æœå­—å…¸çš„é”®ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œä¼šæŠ¥é”™ã€‚

```python
# âŒ é”™è¯¯ç¤ºä¾‹
dict1 = {1: 'a', 2: 'b'}
dict2 = {3: 'c'}
merged = dict(dict1, **dict2)  # TypeError!
```

---

## æ–¹æ³•å››ï¼šChainMap

`collections.ChainMap` æä¾›äº†ä¸€ç§**è§†å›¾çº§åˆ«çš„åˆå¹¶**ã€‚

```python
from collections import ChainMap

dict1 = {'a': 1, 'b': 2}
dict2 = {'b': 3, 'c': 4}

merged = ChainMap(dict1, dict2)
print(merged)  # ChainMap({'a': 1, 'b': 2}, {'b': 3, 'c': 4})
print(dict(merged))  # {'a': 1, 'b': 3, 'c': 4}  # è½¬æ¢ä¸ºå­—å…¸
```

### ç‰¹ç‚¹
- **ä¸å¤åˆ¶æ•°æ®**ï¼Œåªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªè§†å›¾
- æŸ¥æ‰¾æ—¶æŒ‰é¡ºåºæœç´¢å„ä¸ªå­—å…¸
- åŸå§‹å­—å…¸çš„ä¿®æ”¹ä¼šåæ˜ åˆ° ChainMap ä¸­

### ä½¿ç”¨åœºæ™¯
å½“ä½ éœ€è¦ï¼š
- **å‰ç¼€ä½œç”¨åŸŸ**ï¼ˆå¦‚åµŒå¥—ä¸Šä¸‹æ–‡ï¼‰
- **åˆå¹¶åä»éœ€è¦ä¿®æ”¹åŸå§‹å­—å…¸**
- **å†…å­˜æ•ˆç‡ä¼˜å…ˆ**ï¼ˆå¤§å‹å­—å…¸ï¼‰

### å®é™…æ¡ˆä¾‹
```python
# æ¨¡æ‹ŸåµŒå¥—ä½œç”¨åŸŸ
local_vars = {'x': 1}
global_vars = {'x': 2, 'y': 3}

scope = ChainMap(local_vars, global_vars)
print(scope['x'])  # 1ï¼ˆå…ˆæŸ¥æ‰¾ local_varsï¼‰
print(scope['y'])  # 3ï¼ˆåœ¨ global_vars ä¸­æ‰¾åˆ°ï¼‰

# ä¿®æ”¹åŸå§‹å­—å…¸
local_vars['z'] = 5
print(scope['z'])  # 5ï¼ˆChainMap è‡ªåŠ¨åæ˜ å˜åŒ–ï¼‰
```

---

## æ–¹æ³•äº”ï¼š| è¿ç®—ç¬¦ï¼ˆPython 3.9+ï¼‰

Python 3.9 å¼•å…¥äº†**åˆå¹¶è¿ç®—ç¬¦** `|`ã€‚

```python
dict1 = {'a': 1, 'b': 2}
dict2 = {'b': 3, 'c': 4}

merged = dict1 | dict2
print(merged)  # {'a': 1, 'b': 3, 'c': 4}
```

### ç‰¹ç‚¹
- **åˆ›å»ºæ–°å­—å…¸**
- è¯­æ³•ç›´è§‚ï¼Œè¯­ä¹‰æ¸…æ™°
- Python 3.9+ æ”¯æŒ

### ä¼˜åŠ¿
ä¸å…¶ä»–è¿ç®—ç¬¦ä¿æŒä¸€è‡´ï¼š
```python
# æ‰©å±•èµ‹å€¼
dict1 |= dict2  # ç­‰åŒäº dict1.update(dict2)

# é“¾å¼åˆå¹¶
merged = (dict1 | dict2) | dict3
```

### ä¸ update() çš„å¯¹æ¯”
```python
# âŒ update() - å°±åœ°ä¿®æ”¹ï¼Œæ— è¿”å›å€¼
dict1.update(dict2)

# âœ… | è¿ç®—ç¬¦ - åˆ›å»ºæ–°å­—å…¸
merged = dict1 | dict2
```

---

## æ–¹æ³•å…­ï¼šdict() + zip()ï¼ˆé«˜çº§æŠ€å·§ï¼‰

è¿™æ˜¯ä¸€ç§æ›´çµæ´»çš„åˆå¹¶æ–¹å¼ï¼Œé€‚ç”¨äº**éå¯¹ç§°åˆå¹¶**ã€‚

```python
dict1 = {'a': 1, 'b': 2, 'c': 3}
dict2 = {'x': 10, 'y': 20}

# ä½¿ç”¨ zip() åˆå¹¶ keys å’Œ values
merged = dict(zip(dict1.keys() + ['extra'], 
                  dict1.values() + [100]))
# {'a': 1, 'b': 2, 'c': 3, 'extra': 100}
```

### æ›´å®ç”¨çš„ä¾‹å­
```python
# æœ‰é€‰æ‹©åœ°åˆå¹¶
keys_to_keep = ['name', 'email']
user_info = {'name': 'Alice', 'email': 'alice@example.com', 'password': 'secret'}
public_info = {k: user_info[k] for k in keys_to_keep}

# åˆå¹¶ä¸¤ä¸ªå­—å…¸ï¼Œä½†åªä¿ç•™ç‰¹å®šé”®
config1 = {'debug': True, 'log_level': 'info', 'timeout': 30}
config2 = {'log_level': 'debug', 'port': 8080}

# åˆå¹¶ï¼šconfig2 è¦†ç›– config1ï¼Œä½†åªå– config2 ä¸­å­˜åœ¨çš„é”®
merged = {k: config2.get(k, config1.get(k)) for k in set(config1) | set(config2)}
```

---

## æ€§èƒ½å¯¹æ¯”

è®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ä¸åŒæ–¹æ³•çš„æ€§èƒ½ï¼š

```python
import timeit

dict1 = {f'key{i}': i for i in range(1000)}
dict2 = {f'key{i}': i + 1000 for i in range(500, 1500)}

# æ–¹æ³•å¯¹æ¯”
methods = {
    'update': lambda: (d1 := dict1.copy()).update(dict2) or d1,
    'unpack': lambda: {**dict1, **dict2},
    'chainmap': lambda: dict(ChainMap(dict1, dict2)),
    'pipe': lambda: dict1 | dict2,
}

for name, func in methods.items():
    time = timeit.timeit(func, number=10000)
    print(f"{name}: {time:.4f}s")
```

**å…¸å‹ç»“æœï¼ˆPython 3.11ï¼‰ï¼š**

| æ–¹æ³• | ç›¸å¯¹é€Ÿåº¦ | å†…å­˜ä½¿ç”¨ |
|-----|---------|---------|
| update() | æœ€å¿« | ä½ï¼ˆå°±åœ°ä¿®æ”¹ï¼‰ |
| \| è¿ç®—ç¬¦ | å¿« | ä¸­ç­‰ |
| å­—å…¸ unpack | å¿« | ä¸­ç­‰ |
| ChainMap | å–å†³äºæŸ¥è¯¢æ¬¡æ•° | ä½ï¼ˆè§†å›¾ï¼‰ |

---

## é€‰æ‹©æŒ‡å—

æ ¹æ®ä½ çš„éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ–¹æ³•ï¼š

| åœºæ™¯ | æ¨èæ–¹æ³• |
|-----|---------|
| å°±åœ°ä¿®æ”¹ï¼Œæ— éœ€ä¿ç•™åŸå§‹æ•°æ® | `update()` |
| åˆ›å»ºæ–°å­—å…¸ï¼Œä¿ç•™åŸå§‹æ•°æ® | `{**d1, **d2}` æˆ– `d1 \| d2` |
| éœ€è¦è§†å›¾è€Œéå‰¯æœ¬ | `ChainMap` |
| éœ€è¦é“¾å¼åˆå¹¶å¤šä¸ªå­—å…¸ | `{**d1, **d2, **d3}` |
| Python 3.9+ï¼Œè¿½æ±‚ä»£ç æ¸…æ™°åº¦ | `d1 \| d2` |
| å¤æ‚çš„é€‰æ‹©æ€§åˆå¹¶ | `dict()` + `zip()` æˆ–å­—å…¸æ¨å¯¼å¼ |

---

## æ€»ç»“

Python æä¾›äº†ä¸°å¯Œçš„å­—å…¸åˆå¹¶æ–¹å¼ï¼Œæ¯ç§æ–¹æ³•éƒ½æœ‰å…¶é€‚ç”¨åœºæ™¯ï¼š

1. **`update()`** - å†…å­˜æ•ˆç‡é«˜ï¼Œä½†ä¼šä¿®æ”¹åŸå§‹å­—å…¸
2. **`{**d1, **d2}`** - Python 3.5+ æ¨èï¼Œç®€æ´ä¼˜é›…
3. **`d1 | d2`** - Python 3.9+ï¼Œè¯­ä¹‰æ¸…æ™°
4. **`ChainMap`** - è§†å›¾çº§åˆ«åˆå¹¶ï¼Œé€‚åˆåµŒå¥—ä½œç”¨åŸŸ
5. **`dict()` + unpack** - ç»å…¸æ–¹æ³•ï¼Œæœ‰é”®ç±»å‹é™åˆ¶
6. **`dict() + zip()`** - é«˜çº§æŠ€å·§ï¼Œé€‚åˆå¤æ‚åœºæ™¯

**æœ€ä½³å®è·µ**ï¼šå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ`{**dict1, **dict2}` æˆ– `dict1 | dict2` æ˜¯æœ€ä½³é€‰æ‹©â€”â€”å®ƒä»¬æ—¢ç®€æ´é«˜æ•ˆï¼Œåˆä¸ä¼šæ„å¤–ä¿®æ”¹åŸå§‹æ•°æ®ã€‚

---

*æœ¬æ–‡ç”±æ—ºæ—º ğŸ• åŸåˆ›ï¼Œå‘è¡¨äº 2026å¹´2æœˆ7æ—¥ã€‚*
